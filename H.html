<!DOCTYPE html>
<html lang="fa">
<head>
  <meta charset="UTF-8" />
  <title>بازی سفینه</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <!-- فونت لاله زار -->
  <link href="https://fonts.googleapis.com/css2?family=Lalezar&display=swap" rel="stylesheet" />
  
  <style>
    html, body {
      margin: 0; padding: 0; overflow: hidden;
      background: black; color: white; font-family: sans-serif;
      height: 100%; touch-action: none; user-select: none;
    }
    canvas {
      display: block;
      background: #111;
    }
    #ui {
      position: fixed;
      bottom: 0;
      width: 100%;
      display: flex;
      justify-content: space-around;
      padding: 10px;
      background: #000;
    }
    .btn {
      background: #333;
      border: 2px solid #555;
      border-radius: 10px;
      color: white;
      padding: 15px;
      font-size: 18px;
      flex: 1;
      margin: 5px;
      user-select: none;
      touch-action: none;
    }
    .btn:active {
      background: #666;
    }
    #hud {
      position: fixed;
      top: 10px;
      left: 10px;
      font-size: 18px;
      background: rgba(0,0,0,0.5);
      padding: 5px 10px;
      border-radius: 10px;
    }
    #message {
      position: fixed;
      top: 50%;
      width: 100%;
      text-align: center;
      font-size: 36px;
      display: none;
      font-family: 'Lalezar', cursive;
      color: #0ff;
      text-shadow:
         0 0 5px #0ff,
         0 0 10px #0ff,
         0 0 20px #0ff,
         0 0 40px #0ff;
    }
  </style>
</head>
<body>

<canvas id="gameCanvas"></canvas>

<div id="hud">❤️ جان: <span id="lives">5</span> | ⭐ امتیاز: <span id="score">0</span> | ⏱ زمان: <span id="time">60</span></div>
<div id="message"></div>

<div id="ui">
  <div class="btn" id="left">◀ چپ</div>
  <div class="btn" id="shoot">🔫 شلیک</div>
  <div class="btn" id="right">راست ▶</div>
</div>

<script>
  const canvas = document.getElementById('gameCanvas');
  const ctx = canvas.getContext('2d');

  const scoreEl = document.getElementById('score');
  const livesEl = document.getElementById('lives');
  const timeEl = document.getElementById('time');
  const msgEl = document.getElementById('message');

  let cw = window.innerWidth;
  let ch = window.innerHeight - 100;
  canvas.width = cw;
  canvas.height = ch;

  let ship = {
    x: cw / 2,
    y: ch - 50,
    width: 40,
    height: 20,
    speed: 5,
  };

  let bullets = [];
  let enemies = [];
  let score = 0;
  let lives = 5;
  let timeLeft = 60;
  let gameOver = false;

  let moveLeft = false;
  let moveRight = false;

  function drawShip() {
    ctx.fillStyle = 'cyan';
    ctx.fillRect(ship.x - ship.width/2, ship.y, ship.width, ship.height);
    ctx.beginPath();
    ctx.moveTo(ship.x - ship.width/2, ship.y);
    ctx.lineTo(ship.x + ship.width/2, ship.y);
    ctx.lineTo(ship.x, ship.y - 20);
    ctx.closePath();
    ctx.fill();
  }

  function drawBullets() {
    ctx.fillStyle = 'yellow';
    bullets.forEach(b => ctx.fillRect(b.x, b.y, 4, 10));
  }

  function drawEnemies() {
    enemies.forEach(e => {
      let gradient = ctx.createRadialGradient(e.x + 10, e.y + 10, 5, e.x + 10, e.y + 10, 15);
      gradient.addColorStop(0, 'red');
      gradient.addColorStop(1, 'darkred');
      ctx.fillStyle = gradient;
      ctx.beginPath();
      ctx.arc(e.x + 10, e.y + 10, 15, 0, Math.PI * 2);
      ctx.fill();
    });
  }

  function updateBullets() {
    bullets.forEach(b => b.y -= 7);
    bullets = bullets.filter(b => b.y > 0);
  }

  function updateEnemies() {
    enemies.forEach(e => e.y += 2);
    enemies = enemies.filter(e => {
      if (e.y > ch) {
        lives--;
        livesEl.textContent = lives;
        if (lives <= 0 && !gameOver) endGame(false);
        return false;
      }
      return true;
    });

    if (Math.random() < 0.02) {
      enemies.push({ x: Math.random() * (cw - 30), y: -30 });
    }
  }

  function detectCollisions() {
    bullets.forEach((b, bi) => {
      enemies.forEach((e, ei) => {
        if (b.x < e.x + 30 && b.x + 4 > e.x && b.y < e.y + 30 && b.y + 10 > e.y) {
          bullets.splice(bi, 1);
          enemies.splice(ei, 1);
          score += 20;
          scoreEl.textContent = score;
          if (score >= 1000 && !gameOver) endGame(true);
        }
      });
    });
  }

  function gameLoop() {
    if (gameOver) return;
    ctx.clearRect(0, 0, cw, ch);

    if (moveLeft) {
      ship.x -= ship.speed;
      if (ship.x - ship.width/2 < 0) ship.x = ship.width/2;
    }
    if (moveRight) {
      ship.x += ship.speed;
      if (ship.x + ship.width/2 > cw) ship.x = cw - ship.width/2;
    }

    drawShip();
    updateBullets();
    updateEnemies();
    detectCollisions();
    drawBullets();
    drawEnemies();

    requestAnimationFrame(gameLoop);
  }

function endGame(win) {
  gameOver = true;
  clearInterval(timer);
  msgEl.innerText = win ? "🎉 تبریک! برنده شدی!" : "😢 باختی! دوباره امتحان کن.";
  msgEl.style.display = 'block';

  if (win) {
    msgEl.style.color = '#0ff';  // نئون آبی (مثل قبلی)
    msgEl.style.textShadow = `
      0 0 5px #0ff,
      0 0 10px #0ff,
      0 0 20px #0ff,
      0 0 40px #0ff
    `;
  } else {
    msgEl.style.color = '#f00';  // قرمز نئون
    msgEl.style.textShadow = `
      0 0 5px #f00,
      0 0 10px #f00,
      0 0 20px #f00,
      0 0 40px #f00
    `;
  }
}


  const leftBtn = document.getElementById('left');
  const rightBtn = document.getElementById('right');
  const shootBtn = document.getElementById('shoot');

  leftBtn.addEventListener('touchstart', e => { e.preventDefault(); moveLeft = true; });
  leftBtn.addEventListener('touchend', e => { e.preventDefault(); moveLeft = false; });
  leftBtn.addEventListener('touchcancel', e => { moveLeft = false; });

  rightBtn.addEventListener('touchstart', e => { e.preventDefault(); moveRight = true; });
  rightBtn.addEventListener('touchend', e => { e.preventDefault(); moveRight = false; });
  rightBtn.addEventListener('touchcancel', e => { moveRight = false; });

  shootBtn.addEventListener('touchstart', e => {
    e.preventDefault();
    if (!gameOver) bullets.push({ x: ship.x - 2, y: ship.y });
  });

  const timer = setInterval(() => {
    if (timeLeft > 0) {
      timeLeft--;
      timeEl.textContent = timeLeft;
    } else if (!gameOver) {
      endGame(false);
    }
  }, 1000);

  gameLoop();

</script>
</body>
</html>
``
